@model FileUploadViewModel
@{
    ViewBag.Title = "File Upload";
    var users = ViewBag.Users as List<dynamic>;
}

<head>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css">

</head>
<div class="d-md-flex d-block align-items-center justify-content-between page-breadcrumb mb-3">
    <div class="my-auto mb-2">
        <h2 class="mb-1">Admin FileUpload</h2>
        <nav>
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item">
                    <a href="index.html"><i class="ti ti-smart-home"></i></a>
                </li>
                <li class="breadcrumb-item">
                    Admin
                </li>
                <li class="breadcrumb-item active" aria-current="page">Admin FileUpload</li>
            </ol>
        </nav>
    </div>

</div>

<br />
<div class="card">
    <div class="card-header d-flex align-items-center justify-content-between flex-wrap row-gap-3">
        <h5 class="mb-0">Admin FileUpload</h5>
    </div>
    <div class="card-body">
        <div class="container mt-5">

            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success">@TempData["Success"]</div>
            }
            @if (TempData["error"] != null)
            {
                <div class="alert alert-danger">@TempData["error"]</div>
            }

            <form method="post" enctype="multipart/form-data" asp-action="AdminFileUpload" asp-controller="FileUpload">
                <div class="form-group">
                    <label for="userId">User</label>
                    <select class="form-control" id="userId" name="UserId" required>
                        @foreach (var user in ViewBag.Users)
                        {
                            <option value="@user.UserId">@user.Email</option>
                        }
                    </select>
                </div>
                @* <div id="dropdownTemplate" style="display: none;">
                @Html.DropDownList("DocumentTypes", ViewBag.AdminDocumentType as SelectList, new { @class = "form-control", @required = true })
                </div> *@
                <div id="fileInputs">
                    <div class="form-group row">
                        <div class="col-md-5" id="dropdownTemplate">
                            <select name="DocumentTypes" class="form-control" asp-items="ViewBag.AdminDocumentType"></select>
                        </div>
                        <div class="col-md-5">
                            <input type="file" class="form-control" name="Files" required>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="btn btn-sm btn-primary addMore" id="addMore"><i class="bi bi-plus-lg"></i></button>
                            <button type="button" style="background:none;border:none" class="removeInput"><i class="bi bi-trash3"></i></button>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>


<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
    $(document).ready(function () {
        $(document).on('click', '.addMore', function () {
            const dropdown = $('#dropdownTemplate').html();
            $('#fileInputs').append(`
                    <div class="form-group row">
                        <div class="col-md-5">
                                ${dropdown}
                        </div>
                        <div class="col-md-5">
                            <input type="file" class="form-control" name="Files" required>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="btn btn-sm btn-primary" id="addMore"><i class="bi bi-plus-lg addMore"></i></button>
                                         <button type="button" style="background:none;border:none" class="removeInput"><i class="bi bi-trash3"></i></button>
                        </div>
                    </div>
                `);
        });

        $(document).on('click', '.removeInput', function () {
            $(this).closest('.form-group').remove();
        });
    });
</script>


<style>
    .form-group {
        margin-bottom: 15px;
    }

    .file-input-row {
        margin-bottom: 10px;
    }

        .file-input-row .form-control {
            margin-bottom: 5px;
        }

    /*  .btn {
             margin-top: 10px;
         } */

    /* Add margin between Add More and Save buttons */
    .form-group button {
        margin-right: 10px;
    }

    .ml-2 {
        margin-left: 10px;
    }

    /* Make the "Remove" button in red and slightly bigger */
    /*  .removeInput {
             background-color: red;
             color: white;
         } */

    /* Space between inputs and buttons */
    .col-md-5, .col-md-2 {
        margin-bottom: 5px;
    }

    /* Adjust width for smaller screen sizes */
    @@media (max-width: 768px) {
        .col-md-5, .col-md-2 {
            margin-bottom: 10px;
        }
    }
</style>